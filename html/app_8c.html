<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CP_CB_Lab6: src/Source_Files/app.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CP_CB_Lab6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2855980263c52be09af3085e80bd06a7.html">Source_Files</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">app.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains all of the functions to set up and start PWM function using LETIMER0, as well as all of the interrupt event handlers for the LETIMER0 peripheral. Also contains i2c transmission functionality to read the temperature from the Si7021 peripheral.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;app.h&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8cdb39575ad0f98ace1c6fbd9c54b83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#ab8cdb39575ad0f98ace1c6fbd9c54b83">app_peripheral_setup</a> (void)</td></tr>
<tr class="memdesc:ab8cdb39575ad0f98ace1c6fbd9c54b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to setup the peripheral drivers for PWM use and Interrupts of LETIMER.  <a href="app_8c.html#ab8cdb39575ad0f98ace1c6fbd9c54b83">More...</a><br /></td></tr>
<tr class="separator:ab8cdb39575ad0f98ace1c6fbd9c54b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a255008f526c267a13ba0ee3c357d0994"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#a255008f526c267a13ba0ee3c357d0994">app_letimer_pwm_open</a> (float period, float act_period, uint32_t out0_route, uint32_t out1_route)</td></tr>
<tr class="memdesc:a255008f526c267a13ba0ee3c357d0994"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses parameters to create structure for the LETIMER PWM driver initilization driver to reference.  <a href="app_8c.html#a255008f526c267a13ba0ee3c357d0994">More...</a><br /></td></tr>
<tr class="separator:a255008f526c267a13ba0ee3c357d0994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af440dd908c925e28e105d9bcf8516130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#af440dd908c925e28e105d9bcf8516130">scheduled_letimer0_comp0_evt</a> (void)</td></tr>
<tr class="memdesc:af440dd908c925e28e105d9bcf8516130"><td class="mdescLeft">&#160;</td><td class="mdescRight">LETIMER0 Comp0 Interrupt Event.  <a href="app_8c.html#af440dd908c925e28e105d9bcf8516130">More...</a><br /></td></tr>
<tr class="separator:af440dd908c925e28e105d9bcf8516130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6978dcac372381b53476f81d10ea85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#add6978dcac372381b53476f81d10ea85">scheduled_letimer0_comp1_evt</a> (void)</td></tr>
<tr class="memdesc:add6978dcac372381b53476f81d10ea85"><td class="mdescLeft">&#160;</td><td class="mdescRight">LETIMER0 Comp1 Interrupt Event.  <a href="app_8c.html#add6978dcac372381b53476f81d10ea85">More...</a><br /></td></tr>
<tr class="separator:add6978dcac372381b53476f81d10ea85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9be61e62f5591d79373d55750d3b907"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#ac9be61e62f5591d79373d55750d3b907">scheduled_letimer0_uf_evt</a> (void)</td></tr>
<tr class="memdesc:ac9be61e62f5591d79373d55750d3b907"><td class="mdescLeft">&#160;</td><td class="mdescRight">LETIMER0 UF Interrupt Event.  <a href="app_8c.html#ac9be61e62f5591d79373d55750d3b907">More...</a><br /></td></tr>
<tr class="separator:ac9be61e62f5591d79373d55750d3b907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11caad952c61c3017d67ea85c8728086"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#a11caad952c61c3017d67ea85c8728086">scheduled_si7021_tempDone</a> (void)</td></tr>
<tr class="memdesc:a11caad952c61c3017d67ea85c8728086"><td class="mdescLeft">&#160;</td><td class="mdescRight">SI7021 Temperature Reading Complete Handler.  <a href="app_8c.html#a11caad952c61c3017d67ea85c8728086">More...</a><br /></td></tr>
<tr class="separator:a11caad952c61c3017d67ea85c8728086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ed4249e24143f1049e9293f6b75f4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#a96ed4249e24143f1049e9293f6b75f4a">scheduled_boot_up_cb</a> (void)</td></tr>
<tr class="memdesc:a96ed4249e24143f1049e9293f6b75f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boot Up Callback used for LEUART.  <a href="app_8c.html#a96ed4249e24143f1049e9293f6b75f4a">More...</a><br /></td></tr>
<tr class="separator:a96ed4249e24143f1049e9293f6b75f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafd9178d69dcf51f180a7b1cc3f5be16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8c.html#aafd9178d69dcf51f180a7b1cc3f5be16">ble_tx_done_cb</a> (void)</td></tr>
<tr class="memdesc:aafd9178d69dcf51f180a7b1cc3f5be16"><td class="mdescLeft">&#160;</td><td class="mdescRight">LEUART TX Complete UART.  <a href="app_8c.html#aafd9178d69dcf51f180a7b1cc3f5be16">More...</a><br /></td></tr>
<tr class="separator:aafd9178d69dcf51f180a7b1cc3f5be16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains all of the functions to set up and start PWM function using LETIMER0, as well as all of the interrupt event handlers for the LETIMER0 peripheral. Also contains i2c transmission functionality to read the temperature from the Si7021 peripheral. </p>
<dl class="section author"><dt>Author</dt><dd>Connor Peskin </dd></dl>
<dl class="section date"><dt>Date</dt><dd>September 10, 2020 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a255008f526c267a13ba0ee3c357d0994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a255008f526c267a13ba0ee3c357d0994">&#9670;&nbsp;</a></span>app_letimer_pwm_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_letimer_pwm_open </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>act_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>out0_route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>out1_route</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses parameters to create structure for the LETIMER PWM driver initilization driver to reference. </p>
<p>Using the parameters passed, this function creates an <a class="el" href="struct_a_p_p___l_e_t_i_m_e_r___p_w_m___type_def.html">APP_LETIMER_PWM_TypeDef</a> structure and passes it to letimer_pwm_open for PWM driver init. It then calls for the LETIMER to start counting.</p>
<dl class="section note"><dt>Note</dt><dd>This function should be called prior to starting the LETIMER counting, as LETIMER must be configured to run in PWM format.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">float</td><td>float value in seconds of how long the PWM value should remain in logic 0 (low).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">float</td><td>float value in seconds of how long th PWM should remain in logic 1 (high) (active).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint32_t</td><td>unsigned 32bit int with the location of the first routed output. Going to LETIMER_ROUTELOC0 register.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">uint32_t</td><td>unsigned 32bit int with the location of the second routed output. Going to LETIMER_ROUTELOC0 register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab8cdb39575ad0f98ace1c6fbd9c54b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8cdb39575ad0f98ace1c6fbd9c54b83">&#9670;&nbsp;</a></span>app_peripheral_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_peripheral_setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to setup the peripheral drivers for PWM use and Interrupts of LETIMER. </p>
<p>This function calls the CMU initialization driver, GPIO init driver, and LETIMER PWM init driver prior to starting the LETIMER. The BLE module is also opened using LEUART and a circular buffer.</p>
<dl class="section note"><dt>Note</dt><dd>This function should be called to initialize all peripherals. </dd></dl>

</div>
</div>
<a id="aafd9178d69dcf51f180a7b1cc3f5be16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafd9178d69dcf51f180a7b1cc3f5be16">&#9670;&nbsp;</a></span>ble_tx_done_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ble_tx_done_cb </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LEUART TX Complete UART. </p>
<p>This will be called at the end of the LEUART TX state machine. It will check the circular buffer to see if there is still data and send if there is.</p>
<dl class="section note"><dt>Note</dt><dd>Corresponds with scheduled event 'BOOT_UP_CB' </dd></dl>

</div>
</div>
<a id="a96ed4249e24143f1049e9293f6b75f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ed4249e24143f1049e9293f6b75f4a">&#9670;&nbsp;</a></span>scheduled_boot_up_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduled_boot_up_cb </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boot Up Callback used for LEUART. </p>
<p>This function will be called upon booting up the device and will print "Hello World" to the LEUART peripheral. If BLE_TEST_ENABLED is defined, this function will test the LEUART communication with the peripheral.</p>
<dl class="section note"><dt>Note</dt><dd>Corresponds with scheduled event 'BOOT_UP_CB' </dd></dl>

</div>
</div>
<a id="af440dd908c925e28e105d9bcf8516130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af440dd908c925e28e105d9bcf8516130">&#9670;&nbsp;</a></span>scheduled_letimer0_comp0_evt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduled_letimer0_comp0_evt </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LETIMER0 Comp0 Interrupt Event. </p>
<p>The COMP0 event will currently do nothing. </p><dl class="section note"><dt>Note</dt><dd>Code should currently not enter this event handler, it will always assert to false and stop the running program. </dd></dl>

</div>
</div>
<a id="add6978dcac372381b53476f81d10ea85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add6978dcac372381b53476f81d10ea85">&#9670;&nbsp;</a></span>scheduled_letimer0_comp1_evt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduled_letimer0_comp1_evt </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LETIMER0 Comp1 Interrupt Event. </p>
<p>The COMP1 event will currently do nothing.</p>
<dl class="section note"><dt>Note</dt><dd>Code should currently not enter this event handler, it will always assert to false and stop the running program. </dd></dl>

</div>
</div>
<a id="ac9be61e62f5591d79373d55750d3b907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9be61e62f5591d79373d55750d3b907">&#9670;&nbsp;</a></span>scheduled_letimer0_uf_evt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduled_letimer0_uf_evt </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LETIMER0 UF Interrupt Event. </p>
<p>The UF interrupt handler is being used to cycle through energy modes. Upon entering the underflow interrupt event the energy mode will change.</p>
<dl class="section note"><dt>Note</dt><dd>This will not cycle into the EM4 energy mode, as we need the low frequency clocks for the LETIMER interrupts. </dd></dl>

</div>
</div>
<a id="a11caad952c61c3017d67ea85c8728086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11caad952c61c3017d67ea85c8728086">&#9670;&nbsp;</a></span>scheduled_si7021_tempDone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduled_si7021_tempDone </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SI7021 Temperature Reading Complete Handler. </p>
<p>Will get the temperature (F) reading from the private variable in SI7021.c using the tempConvert command. If the temperature is above 80 (F), LED1 will be asserted. If the temperature is below 80 (F), LED1 will be deasserted. The result temperature data will be transmitted to the HM18 peripheral via LEUART.</p>
<dl class="section note"><dt>Note</dt><dd>Corresponds with scheduled event 'I2C_7021_READ_CB' </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
